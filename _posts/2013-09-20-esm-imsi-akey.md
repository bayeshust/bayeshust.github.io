---
title: 电信写号三码与五码
layout: post
category: 经验总结
tagline: ""
tags: []
redirect_from: "/post/2013/09/ESN-IMSI-AKEY.html"
---

3 码包括哪些？

ESN、IMSI、AKEY

5 码包括哪些？

五码分别是：IMSI，AKEY， ESN，AN，AAA。
ESN、IMSI、AKEY、AN/AAA 账号、AN/AAA 密码

3 码 5 码有什么作用？

## 几个术语

### ESN
ESN 是电子序列号**Electronic Serial Number**的缩写，这个码应该叫做机器码的，国外的机卡一体机在国外入网的时候，一般将机器自带的机身 ESN 码提供给运营商的，运营商就是根据用户的机身 esn 为基础，然后加入其它的数据使电话正常使用的。我们在国内见到的 cdma 机器都有 ESN 码的，但是这个 ESN 不是我们所理解的 esn 码，因为国内的是机卡分离的机器，所以用户的 esn 码是写在 UIM 卡中的。每部手机都被分配了一个电子序列号，在每次呼叫过程中，它能被传送到电话中心，移动电话每次接收时都要验证对方的电子序列号。

### IMSI
**国际移动用户识别码**,International Mobile Subscriber Identity ，国际上为唯一识别一个移动用户所分配的号码，IMSI 码即我们的手机号码，但是电信分配的内部识别号码，外部就是我们的 133xxx 手机号码。 从技术上讲，IMSI 可以彻底解决国际漫游问题。但是由于北美目前仍有大量的 AMPS 系统使用 MIN 号码，且北美的 MDN 和 MIN 采用相同的编号，系统已经无法更改，所以目前国际漫游暂时还是以 MIN 为主。其中以 O 和 1 打头的 MIN 资源称为 IRM(International Roaming MIN)，由 IFAST (International Forum on ANSI-41 Standards Technology) 统一管理。目前联通申请的 IRM 资源以 09 打头。可以看出，随着用户的增长，用于国际漫游的 MIN 资源将很快耗尽，全球统一采用 IMSI 标识用户势在必行。
IMSI 共有 15 位，其结构： IMSI = MCC + MNC + MSIN，其中 MCC 是指移动台国家代码（3 位，中国 460），MNC 是指移动网代码（2 位中国 00），MSIN 是指移动用户识别号码 (10 位）

IMSI 共有 15 位，其结构如下：IMSI = MCC + MNC + MSIN

- MCC：Mobile Country Code，移动国家码，共 3 位，中国为 460;
- MNC：Mobile Network Code，移动网络码，共 2 位，中国电信 CDMA 系统使用 03
- MSIN: Mobile Subscribler Identification Number，移动用户识别码，共有 10 位，其结构如下：
	09+M0M1M2M3+ABCD，其中的 M0M1M2M3 和 MDN 号码中的 H0H1H2H3 可存在对应关系，ABCD 四位为自由分配。可以看出 IMSI 在 MIN 号码前加了 MCC，可以区别出每个用户的来自的国家，因此可以实现国际漫游。在同一个国家内，如果有多个 CDMA 运营商，可以通过 MNC 来进行区别。
	一个典型的 IMSI 号码为 460 03 0912121001;

### A-key
A-key 是存储在 MS 中进行鉴权和加密的密钥，是分配给 MS 的 64bit 数据，并且仅对 MS 和相关的归属位置寄存器鉴权中心（HLR/AC）是可知的。

CDMA 系统在 UIM 卡中存储的信息可以分为三类：

- 第一类是**用户识别信息和鉴权信息**，主要是 IMSI 号码和 CDMA 系统的专有的鉴权信息，其中包括 A-Key、SSD-A 和 SSD-B。
- 第二类是**业务信息**， CDMA 系统中与业务有关的信息存储在 HLR 中，这类信息在 UIM 卡中并不多，主要有短消息状态等信息。
- 第三类是**与移动台工作有关的信息**，包括优选的系统和频段，归属区标识（SID、NID 组）等参数。除上述保证系统正常运行的信息以外，用户也可以在 UIM 卡中存储自己使用的信息，如电话号码本等。

### AN
(Access Network 接入网）：根据近些年来电信网的发展趋势，国际电信联盟电信标准化部门（ITU-T）提出了“接入网”的概念。接入网的定义是：电信部门业务节点与用户终端设备之间的实施系统。它可以部分或全部代替传统的用户本地线路网，并可包括复用、交叉连接和传输功能。是可以将各种用户接入到业务接点、能支持包括窄带和宽带多种业务综合接入的接入网。

### AAA
身份验证 (Authentication)、授权 (Authorization) 和统计 (Accounting)Cisco 开发的一个提供网络安全的系统


每个手机出厂时都有一个 ESN 号，MIN 号是运营商分配的，用以区别用户，一个手机能够正常服务，在交换上写号时必须输入 ESN。这个 ESN 号和 MIN 号是一一对应的，在鉴权时使用，对于机卡不分离手机，需要写号时只需提供手机中的 ESN 号给交换人员，他们会分配一个 MIN 号给你，在手机中写入即可。在用户鉴权时会用到手机中固有的 ESN 号，所以对于不同的机卡合一手机，由于 ESN 号不同，把获得的 MIN 值写入其它手机，手机可以识别网络，但无法通过鉴权，故无法通话；对于机卡分离的手机，手机出厂时也有 ESN 号，但在写号时在 UIM 卡中另外写入一个 ESN 号，所以手机鉴权时不用手机中固有的 ESN 号，而是用 UIM 卡中人为写入的 ESN 号，这样 UIM 卡就可以做到放入任何一个 C 网手机中都可以打电话。

一个机卡合一的手机进入 CDMA 网工作，最初只需要三个数据：一是 ESN 码；二是 IMSI 码（机卡合一写在手机里面，机卡分离的 ESN IMSI 在卡里面）；三是鉴权码，存储的位置和 IMSI 一样。

## 写号目的
就是保持电信机房 ESN（指的是手机 UIM 卡里的 ESN）等于手机机身内部的 ESN。
每个手机出厂时都有一个 ESN 号，MIN 号是运营商分配的，用以区别用户，一个手机能够正常服务，在交换上写号时必须输入 ESN。这个 ESN 号和 MIN 号是一一对应的，在鉴权时使用，对于机卡不分离手机，需要写号时只需提供手机中的 ESN 号给交换人员，他们会分配一个 MIN 号给你，在手机中写入即可。在用户鉴权时会用到手机中固有的 ESN 号，所以对于不同的机卡合一手机，由于 ESN 号不同，把获得的 MIN 值写入其它手机，手机可以识别网络，但无法通过鉴权，故无法通话；对于机卡分离的手机，手机出厂时也有 ESN 号，但在写号时在 UIM 卡中另外写入一个 ESN 号，所以手机鉴权时不用手机中固有的 ESN 号，而是用 UIM 卡中人为写入的 ESN 号，这样 UIM 卡就可以做到放入任何一个 C 网手机中都可以打电话。一个机卡合一的手机进入 CDMA 网工作，最初只需要三个数据：一是 ESN 码；二是 IMSI 码（机卡合一写在手机里面，机卡分离的 ESN IMSI 在卡里面）；三是鉴权码，存储的位置和 IMSI 一样。

方法：

1. 改电信机房 ESM 等于手机机身内部 ESN
2. 改手机内部 ESN 等于电信机房 ESN（指的是手机 UIM 卡里的 ESN）

具备 ESN、IMSI、A-KEY 编码，你的手机入网打电话收发短信等基本通讯功能已经搞定了，上 EV-DO（3G）则需要：AN、AAA 码

ESN（这个码应该叫做机器码的，国外的机卡一体机在国外入网的时候，一般将机器自带的机身 ESN 码提供给运营商的，运营商就是根据用户的机身 esn 为基础，然后加入其它的数据使电话正常使用的，我们在国内见到的 cdma 机器都有 ESN 码的，但是这个 ESN 不是我们所理解的 esn 码，因为国内的是机卡分离的机器，属于用户的 esn 码是写在 UIM 卡中的）

AKEY 码
（鉴权码）顾名思义，就是手机登录网络时候校验用的，正规的一体机写号，实际就是把 imsi 和 a-key 写入手机，并在电信内部系统登记三个码的对应关系。手机登录网络，把一体机或 uim 卡上的这三个码和交换机上的三码进行校验，正确及为合法用户。（这种写号方法我不了解，看似可行，但肯定对硬件做了改动，故不作评论）

已有号码的，两种情况
读取老手机的 esn 和 imsi 号，通过关系获得 a-key（绝非通过关系换算，如果不是通过某种方式直接读用户的 UIM 卡，剩下的可能我就不说了，嘿嘿）
读取老手机的 esn 和 imsi 号，通过关系关闭鉴权（即取消了 a-key 和其他两个码的对应关系），写入这两个号就可以了，但存在孖机风险。
写号的关键在于写入的三码对应关系和电信网内的记录一致。由于 a-key 一般情况下不能在客户端获得，所以如果关闭鉴权，那么用户只需要 esn 和 imsi 码即可，增加了孖机的风险，因为 ESN 和 imsi 都可以通过软件自行写入。（确实如此。不过发觉可能被盗了也没关系，去营业厅换一张 UIM，再按之前的操作方式改为一体机就可以了）
1. 关闭鉴权，这个方法路人皆知，所以内部也是控制非常严格。
2. 在计费系统读出 AKEY。
3. 在系统将 AKEY 改为 0000000000000000, 等同于关闭鉴权。
4. 修改系统 AKEY 为新的任意值，同时记录这个 AKEY，等同于读出 AKEY，比方法 3 区别在并没有关闭鉴权。
5. 接触到未开通的等待换卡用的 UIM 卡数据库，记录其中一个卡号，IMSI,UIM ID(ESN),AKEY，去前台做原号码换卡操作，录入你记录的卡号，领到这张卡不用，将三个参数写到机卡合一手机。


## CDMA 鉴权及读码知识

### 鉴权
国内的 CDMA 手机和目前国外的手机唯一不同的地方是–机卡分离，这是个优点，因为他可以适应发展中国家这种换机不换号的特点（咱们资源有限，人太多）。但是也有缺点，就是相对目前五大洲所有使用 CDMA 机卡一体手机而言。因为在国外，手机号不像国内这种，需要好号，需要顺子号等等的迷信需求，他们的号码直接就使用交换机用于识别手机个体的识别码，比如我们知道的十位 imsi，而国内是将 133********作为一个号码平台，把他和十位 imsi 一一对应起来，就有了咱们的所谓 133 特服号打头的手机号码了，你要五个 8，六个 7，其实手机本身的号码并不一定很好，兴许 imsi 还是个带 444 呢！至于鉴权呢，就是介于 133 平台和 imsi 之间的一个必要识别步骤，他需要在极短的时间内对个人手机的用户信息（当然不是你叫什么之类的数据了），包括所属地区代码，是否漫游状态等等进行识别，顾名思义，鉴权就是鉴别权利。鉴权处理是筛选合法用户，并允许接入网络取得服务的过程，鉴权处理必须在位置登记、移动台呼叫的终止与发起前完成。
鉴权过程：实际是一个“询问与响应”的过程，首先由交换生成一个鉴权参数 AUTHR，称为鉴权响应，根据 CDMA 用户鉴权算法（简称 SAC)，由一个随机号码 RAND、共享密码数据 SSD、电子系列号 ESN、移动台识别号 MIN 组成。该参数与 RAND 随机数一起被移动台（手机）送往识别中心，由识别中心利用自身用户鉴权参数、存储的 SSD 与从手机（应该说是移动台）接收的 RAND 重新生成一个 AUTHR，如果新的 AUTHR 与从移动台处收到的 AUTHR 一致，就说明鉴权成功，允许服务。如果两个 AUTHR 不一致，将由识别中心启动一个唯一询问过程重新来一次鉴权。对于机卡一体机，由于无法获得 SSD，也就无法完成以上鉴权过程，因此，必须在识别中心关闭该号码的鉴权过程，方可正常使用。也就是说，每个号码都鉴权，用韩机只能把鉴权关了，烧号以后才能正常使
用。

### 关鉴权
关掉鉴权就是要把 133 平台绕过去，因为机卡一体手机与交换机握手的时候发射的识别信息是十位 imsi，而不是 133********，所以网络会认为你的号码有误！所以，关鉴权是机卡一体手机在国内使用的必需步骤。这里需要声明一件事：为什么联通不让关鉴权？因为关掉鉴权就等于放弃对手机的安全信息的保密性了，如果手机都是不用鉴权信息就可以登录网络，那遇到扒机怎么办！所以，关鉴权以后，联通或是默许，或是反对，或是给你重新打开，因为三个字“不合法”！

### 交卡关鉴权
为什么要交卡呢！现在机卡一体手机关鉴权主要通过两种途径，一种找人关，这样的关法无需交 uim 卡，插卡和一体机都能够使用，但是需要把卡里面的 esn 写进机卡一体机，使卡内的 esn 和一体机的 esn 保持一致，这样就等于你给自己扒机了！有缺点—卡和一体机不能同时使用，否则……后面讲。第二种是通过当地联通关于机卡一体机入网使用的相关政策，把卡交给联通公司，这样的好处是，联通通过机房把你的卡的 esn 改成你的一体机的 esn（一体机本身有 esn，需要在你交卡的时候提供给营业人员，但是各地关于一体机的入网政策不一样，所以不要随便敏感词语已过滤卡给别人，要先问清楚了。）这样做的好处是卡不能使用了，机器安全了，避免了被人扒机。综上，还是交卡好！为什么呢，你总不会想在自己的手机被人莫名其妙的扒机后产生了莫名费，还要投诉说联通吃费吧！因为联通没收回你的卡，所以一切后果由你本人全部承担，概不负责！

### 一机多号的实现方式
2 个 133 的号码想同时在一台韩机上使用，必须有一个号码在连通改变其 esn, 这样 2 个号码的 esn 都一样了，再在手编里不同的信道上做不同的 imsi, 然后你在菜单的信道选择里切换即可。举例：13333333333 和 13388888888 想同时在 v420 上使用，不用今天写这个号码明天写那个号码这样切换，只需在联通机房把其中的一个号码的 esn 改成和另一个号码一样的 esn, 比如改后 13333333333 和 1338888888 的 esn 都是，3000000 了，然后再通过手编，把 13333333333 和 13388888888 的 imsi 分别作到两个不同的信道里，这时记住这两个号码对应的信道，使用时在“话机设置”的“信道选择”菜单里切换这 2 个信道即可，1333333333 作到第 4 个信道里，那菜单里选第 4 个信道，机器重启后你用的就是 13333333333 这个号码了，13388888888 作到第 3 个信道里，那菜单里选第 3 个信道，机器重启后你用的就是 13388888888 这个号码了。

## 行机和韩机读数据 esn 和 imsi 的方法
1. 三星插卡的 cdma 读 ESN 和 IMSI 方法一：
- 输入*759#813580，出现界面模式
- 按 2 键，再按 4 键 ，连按 4 次*键，调出 8 位的 ESN ，由数字和字母组成
- 按 2 键，再按 2 键 ，连按 5 次*键，调出 10 位的 IMSI，为 10 位数字数字，第一位为 0
- 按#02 退出

2. 三星插卡的 cdma 读 ESN 和 IMSI 方法二：
- 按左上角菜单键，再按数字 6 键，再按*键，输入密码 000000 进入系统程序，
- 第一个菜单就是 ESN，记下八位数值，
- 第二个就是 NAM1 Phone Number 显示的就是 IMSI 号码。一直按 OK 直到退出

3. lg 插卡 cdma 手机读 ESN 和 IMSI 方法：
- 按菜单键，按 0 键，输入密码 000000，
- 按确认键，查找 esn 字样，找到后记下数据，
- 同理查找 nam 字样，即 imsi（以上中文界面）

4. 摩托罗拉 V680 读 ESN 和 IMSI 方法：
- 输入 25*#然后按录音键两下，然后输入 071082，按 3，再按 3，
- 显示 15 位数字，后 10 位为要查询的 IMSI 码
- 例如：460030932242687（前五位删除，NAM 为：0932242687）
- 输入 25*#然后按录音键两下，然后输入 071082，按 4，再按 9，显示的是 8 位 ESN 码。

5. 韩机读 ESN 和 IMSI 方法：
- 输入 5809540*45680，出现界面模式
- 按 2 键，再按 4 键 ，连按 4 次*键，调出 8 位的 ESN ，由数字和字母组成
- 按 2 键，再按 2 键 ，连按 5 次*键，调出 10 位的 IMSI，为 10 位数字数字，第一位为 0
- 写号成功后不能在营业厅补卡，不然 ESN 会改变，导致不能电话需要重新关鉴权或者重新写入新的 esn

参考资料：

- [http://www.jicow.com/archives/453.html](http://www.jicow.com/archives/453.html)
- [http://www.yqfly.com/pda/dianxincdmashoujishaohaosanmawumazhishi.html](http://www.yqfly.com/pda/dianxincdmashoujishaohaosanmawumazhishi.html)
- [http://zhidao.baidu.com/question/409234384.html](http://zhidao.baidu.com/question/409234384.html)
